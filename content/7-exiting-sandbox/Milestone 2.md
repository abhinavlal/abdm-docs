+++
title = " Milestone 2"
date = 2023-03-13T14:30:25+05:30
weight = 6
chapter = true
pre = "<b>7.2</b>"
+++

# Milestone 2

**Description of Milestone 2**: Building Health Information Provider (HIP) services to share digital records via any Personal Health Records (PHR) app. 


# Test Cases

| Test Case# | Test Title | Test Summary | Optional/Mandatory | Test Steps | Expected Result | Actual Result | Status | Notes |
| ----------- | ----------- | ----------- | ----------- |----------- | ----------- | ----------- | ----------- | ----------- |
|USER INIT DISCOVER CARE CONTEXT 01 NEW|User should be able to discover their own health records at health facilities they have visited in the past.|User should be able to discover their own health records at health facilities they have visited in the past.|Mandatory|1. User logs in PHR app. 2. User seraches for health provider ( provider can be hospitals, labs, clinics, nursing home, doctor, govt health program, telemedicine provider). It is important that the HIP should be easily identifiable by the user to search for their health records. User can add a specific identifier provided by the health provider to improve discovery. (for example - Hospital Patient id). 3. User consents to sharing their demographic details with HIP. 4. HIP get Demographic information including verified and unverified identifier. 5. HIP searches their records for any of the verified identifers; Most commonly search should be first done on ABHA address; if no match then search with Mobile number. On mobile number match HIP to do a fuzzy logic match on matched records. 6. HIP does a fuzzy demographic match ( similarity on name ; +/-2 on age ; gender - exact match). 7. HIP returns list of care context for the matched user.| Records of patients already registered in EMR/.HMIS system should be discoverable if the demographic +mobile information matches. All records for the user, including historical records across the years should be discoverable. |Able to see the records||||
USER_INIT_LINK_CARE_CONTEXT_02 NEW|User should be able to link a discovered care context|User should be able to link a discovered care context|Mandatory|1. User does a discovery request with the provider and get the list of care context. 2. User should be able to select a care context ( multiple selection - in future - under development) and initiate linking. 3. HIP must send a OTP to the verified id ( typically mobile / email). 4. User to enter OTP on PHR app. 5. HIP must link the care context if the OTP matches|Selected care context should be linked to the ABHA address. HIP must save the ABHA address provided as part of discovery call with this patient in their records.|Care context linked to ABHA address||||
HIP_INIT_LINK_CARE_CONTEXT_01|HIP should link care context with ABHA address when a new health record is generated and ready to be shared with the patient. This test case is applicable when ABHA address has been shared with HIP during patient registration, OR via discovery and linking||Mandatory|1. New health record like Diagnostic report| Prescription| etc is created on EMR/HMIS system for a patient. 2. ABHA address of the patient is available in EMR/HMIS system. 3. EMR / HMIS system checks if it has unused linking token. This linking token is obtained usually during registration. 4. If no linking token is available then system obtains new token by performing a demographic auth on the gateway. 5. Care Context is linked with the ABHA address on the HIE-CM. 6. Display text in the care context must provide information to the patient that helps them recognize the type of health records.|1. Care context is linked automatically on creation of new health record. 2. Notification of health record should be visible to the patient on their PHR app.|Able to see the records in the PHR app||||
HIP_INIT_NOTIFY_HIECM_02|HIP should update HIE-CM when a new health record is generated & is being added to the already existing care context. This test case is applicable when ABHA address has been shared with HIP during patient registration, OR via discovery and linking. It is recommended that only one care context should be created for each in-patient episode and a care context of every out-patient episode.||Mandatory|1. New health record like Diagnostic report, Prescription, etc is created on EMR/HMIS system for a patient. 2. ABHA address of the patient is available in EMR/HMIS system. 3. EMR / HMIS system checks if health record will be part of an already exsting care context. 4. EMR/HMIS system will call the notify API on the gateway to inform addition of new health record to an existing care context.|Notification of new health record should be visible to the patient on their PHR app.|New health record can be seen||||
HIP_INIT_NOTIFY_HIECM_03|HIP should notify HIE-CM when a new health record is generated & ABHA address is not available.This test case is applicable when patient has shared mobile number and has NOT shared ABHA address with HIP during patient registration.||Mandatory|1. New health record like Diagnostic report, Prescription, etc is created on EMR/HMIS system for a patient. 2. ABHA address of the patient is NOT available in EMR/HMIS system. 3. Mobile number of patient is available in EMR/HMIS system. 4. EMR/HMIS system will call the SMS/notify2 API on the gateway to inform of available of new health record (only the mobile number and the HIP ID is to be shared)|1. ABDM should be sending notification to the patient on their mobile with deep link. 2. Patient should be able to download/launch PHR app of their choice. 3. PHR app will make a discovery request to the HIP. 4. Care context for New patient record must be correctly discoverable in the PHR app.|SMS sent with deep link||||
HIP_INIT_GRANT_CONSENT_04|HIP must save consent (s)granted for a ABHA address in their system||Mandatory|1. Initiate a new consent request for HIP on HIU web interface on sandbox.2. Grant the request for this consent on PHR app. 3. HIP will be notified of granted consent request"|1. Verify the HIP has saved the granted consent request as part of EMR/HMIS system|Consent request seen in HMIS||||
HIP_INIT_REVOKE_CONSENT_05|HIP must delete consents for  a ABHA address in their system when it is revoked||Mandatory|1. Select a granted consent request for this HIP in the PHR app. 2. Revoke consent on PHR app. 3. HIP will be notified of revoked consent |1. Verify the HIP has deleted the consent as part of EMR/HMIS system upon revoke by patient|Consent revoked seen in HMIS||||
HIP_INIT_ABHA_OPTOUT_07|HIP must delete ABHA address & all associated consents in their system when patient opts out of ABDM||Mandatory|1. Patient opt-out of ABHA (HIE-CM Notification sent to HIP to unlink the health records. HIP then send confirmation notification to HIE-CM for unlinking)||||||
HIP_INIT_SHARE_CARECONTEXT_08|HIP must share health records associated with care context on request||Mandatory|1. Initiate a "Get data" for a linked care context in the PHR app. 2. HIP will receive a request to share information along with the consent id & end-point URL where the data must be pushed. 3. HIP must verify that there is a valid consent for sharing this data with the specific HIU making the request. 4. Health records must be shared only for allowed HIP types withing the date ranges granted in the consent. 5. HIP should encrypt the health records to be shared with its long term private key. 6. HIP should push the encrypted data to the end-point URL. 7. On successful transfer, HIP must notify HIE-CM of successful transfer by calling health information notify API. 8. Transfer must be completed within 2 hours of receiving the request.|1. Health records will be successfully received in the PHR app. 2. Health records must be properly decryptable using the HIP public key. 3. Health records shared/ transferred must be in proper FHIR formats defined by ABDM|||||
HIP_INIT_HEALTHRECORD_TYPE_09|For every type of health record being shared by the EMR/HMIS system, verify that they are in the correct FHIR format||Mandatory|1. Create a health record for each type of posible records in the EMR / HMIS system for a patient. 2. Link the care context and initiate a data transfer. 3. Obtain copy of all the type of records in a test HIU system|1. All health records must be correctly validated using the FHIR validator (tool). 2. Records must conform to the ABDM FHIR implementation guide available at nrces.in/ndhm. 3. If unstructured records (eg. Pdfs, jpeg) are being shared, integrators must be educated that they need to move to sharing of structured records within a year.|||||
HIP_INIT_HEARTBEAT_10|Respond to the heartbeat API whenever called||Mandatory|1. Ensure heartbeat API has been implemented by the EMR / HMIS|Check the HIE-CM logs for proper response for heartbeat API|||||


